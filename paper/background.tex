\section{Background}
\label{sec:background}

In this section we cover the background of Namecoin. We begin by looking at the history of the cryptocurrency and then explain why a block chain can be used for our definition of a namespace. We then proceed to discuss the technical design of Namecoin and the mechanisms used in the design. We conclude this section with discussion about the applications of Namecoin.

\subsection{History}

Namecoin is an alternative cryptocurrency modeled after Bitcoin\cite{nakamoto2008bitcoin}. Furthermore, it is the first altcoin in the sense that it was the first to create its own block chain, separate from Bitcoin's.  Namecoin shares many similarities with Bitcoin, including the same method for proof-of-work, the same coin cap, the same block creation time, and all of the same transaction operations (with a few additions). Namecoin was inspired after discussions about a BitDNS\cite{bitdns} protocol using a block chain to manage a domain name lookup service. The idea behind this was that a central authority managing domain names, such as ICANN, requires too much trust in a single entity. Having a decentralized name system described by BitDNS provides resistance against a single point of failure. The first Namecoin block was mined in April 2011, and as of the writing of this paper, over 215,000 total blocks have been mined in the Namecoin system. Because of its similarities with Bitcoin, Namecoin was able to be merge-mined and has been merge-mined with Bitcoin since October 8, 2011. 

\subsection{Description of the Block Chain}
\cite{}
Namecoin is minted and maintained by a decentralized peer-to-peer network. Nitcoin transactions require the digital signature of the account holder to prevent theft, and every transaction is published in an append-only hash chain, called the block chain. The block chain can be extended with new transactions by any participant, and such participants (informally known as miners) may obtain newly minted Bitcoin currency (NMC) and/or tips from the transactions for performing this function. However extensions to the block chain require a proof-of-work that rate-limits the process (to approximately an extension every ten minutes) that enables a steady inflation rate, ample competition among participants to extend the block chain, and adequate time to obtain and verify the history of the block chain for new participants. Informally, the proof-of-work protocol in Namecoin is intended to maintain the following two essential properties about the block chain:

-Every party eventually agrees on the order and correctness of transactions in the block chain.

-Any party can publish a transaction (for a fee), which will then be verified and, if valid, included in the block chain within a small bounded delay

A use case for a block chain is a tamper-evident log. That is, it can be used as a data structure that stores a bunch of data, and allows users to append data onto the end of the log. Each new block has a hash of the previous block, so if somebody alters data that is earlier in the log, it will be detected. If an adversary wants to tamper with data anywhere in this entire chain, in order to keep the story consistent, he's going to have to tamper with the hash pointers all the up to and including the current block. Thus it emerges, that by just remembering this single hash pointer of the head of the chain, users essentially remember a tamper-evident hash of the entire list, all the way back to the genesis block. Namecoin, and all block chain based cryptocurrencies, use this tamper-evident log in order to record all the transactions between individuals. 


{\bf Block chain security.}
The value and stability of a cryptocurency are directly related to the amount of proof-of-work involved in the calculations of the blocks because this work is what keeps the data distributed and secure in the tamper proof block chain. For both Bitcoin and Namecoin, the proof-of-work is shown by calculating the hash of a new block and a random nonce over and over until the calculated hash has a certain number of leading zeros. The number of leading zeros required by the hash is referred to as the difficulty threshold. Namecoin enjoys a very high difficulty threshold for the proof-of-work. Namecoin is able to do this because it is similar to Bitcoin and supports merge mining with Bitcoin. This allows miners who are mining Bitcoin to also mine Namecoin at the same time with no extra work for the miner. Essentially, this is because the miner is using their computational power to solve a cryptographic puzzle that satisfies the proof-of-work for both block chains at the same time. This is advantageous for the miners because they are rewarded with coins from both systems, and helps Namecoin because it gives the Namecoin network a vastly increased amount of hash power over what it would have if it did not support merged mining. The high hash power and difficulty of the cryptographic challenge on the Namecoin network increases the stability of the system, providing resilience to a 51\% attack and other threatening behaviours from malicious miners.

\subsection{Technical Details of Names}

In this section and the next, we make an effort to differentiate between the technical details of the Namecoin name/value implementation and the specific mechanism design choices in Namecoin. The feature that separates Namecoin from Bitcoin is that Namecoin is a namespace, and can be used to register name/value pairs that can be stored in the block chain and traded amongst individuals. This registration is done using the three script operations exclusive to Namecoin: {\tt NAME\_NEW}, {\tt NAME\_FIRSTUPDATE}, and {\tt NAME\_UPDATE}. In order to understand the registration process, we think it is helpful to walk through the registration process of a name, roughly following Figure \ref{fig:registration}. 

{\bf NAME\_NEW.}
To start, the user will need to select a coin to be crafted into a token (or special coin) that represents a name and whose value can be changed by whoever possess the token. The next step to register a name is to make a transaction that uses the {\tt NAME\_NEW} script operation in a transaction sending the token from one of their addresses to another. Using {\tt NAME\_NEW}, a user can indicate an interest in a new name for a name/value pair by posting a hash commitment of the desired {\tt name} in the scriptPubKey of the transaction. The {\tt NAME\_NEW} operation acts as a signal in the block chain for name parsers to indicate that the next part of the scriptPubKey will be the hash commitment of {\tt name}. The protocol then places an {\tt OP\_2DROP} on the stack to remove all of the name information put on the stack with the {\tt NAME\_NEW} operation so that the rest of the locking portion of the scriptPubKey can function just as it does in Bitcoin. 

\begin{figure*}
  \centering
  \includegraphics[width=0.95\textwidth]{registration.png}
  \caption{Namecoin Name Registration Protocol}
  \label{fig:registration}
\end{figure*}

{\bf NAME\_FIRSTUPDATE.}
After doing this, and waiting for 12 or more blocks on top of the one containing the {\t NAME\_NEW} transaction, the same user can use the output of the {\tt NAME\_NEW} transaction as the input for the {\tt NAME\_FIRSTUPDATE} transaction. Once completed, this will associate the chosen {\tt name} with a value selected by the user. Similar to {\tt NAME\_NEW}, {\tt NAME\_FIRSTUPDATE} allows data to be posted in the block chain as part of the scriptPubKey of a special transaction. 
To create a {\tt NAME\_NEW} transaction, a user will select, as input, the output of the {\tt NAME\_NEW transaction}. They will then use another address they control as the output for the transaction. The scriptPubKey of this transaction will contain a {\tt NAME\_FIRSTUPDATE}, the {\tt name} desired, the random nonce used in the {\tt NAME\_NEW} hash commitment, the first {\tt value} for the name to take and some {\tt OP\_DROP}s to clear these items from the stack so that they don't interfere with the rest of the locking script, which comes after these extra components. In order for this transaction to be valid, a miner will verify that the {\tt name} and the provided nonce do, in fact, hash to the commitment in the appropriate {\tt NAME\_NEW} transaction. The output of this transaction now contains the token representing the name/value pair, and whoever can unlock and spend the output can utilize the final new operation, {\tt NAME\_UPDATE}.

{\bf NAME\_UPDATE.}
The third and final new operation in Namecoin is the {\tt NAME\_UPDATE} operation. Again, this operation's arguments (the {\tt name} and {\tt newValue}) are stored in the scriptPubKey of a special transaction. This transaction must have as input a {\tt NAME\_FIRSTUPDATE} or {\tt NAME\_UPDATE} output with the same {\tt name}. This operation has three primary uses: updating, renewing and trading a name. If the user wants to change the value associated with a given {\tt name}, they will update {\tt name} with this operation, providing a {\tt newValue}. If names can expire, as they do in Namecoin, then this operation can also be used to renew a name by providing a new value that is the same as the old value. In either of these cases, the user will use an address they control as an output of the transaction. The final reason to make a {\tt NAME\_UPDATE} transaction is to trade the special coin to another user. In this case, the user will put, as an output, one of the other user's addresses instead of their own. Once the transaction resolves, the other user will have control over the special coin and can change the value to whatever they deem fit. Because the ownership of {\tt name} is associated with the ownership of the special coin, if the buyer is paying for the name with Namecoins, the exchange between the payment and the {\tt name} can be atomic (meaning they happen in the same transaction and either are only valid if the other is as well). 

\subsection{Mechanism Design}

In this subsection we continue discussion about the details of Namecoin. As opposed to the last section, however, this section focuses on the specifics of the mechanism design in Namecoin. 

{\bf Fees.}
Namecoin has been implemented with various fees and protocols to incentivize the behaviours of the users. The special token used in the {\tt NAME\_NEW} transaction has a value of 0.01 NMC. This coin will be not be spendable like other Namecoins while it has a name attached to it, but if the name expires, then the coin will resume function as usual. For all of the transactions, {\tt NAME\_NEW}, {\tt NAME\_FIRSTUPDATE}, and {\tt NAME\_UPDATE}, the default behaviour is to have the user tip the miner. The current expected tip, which is programmed into the Namecoin client, is 0.005 NMC on each transaction. Historically, Namecoin also had a network fee attached to the {\tt NAME\_FIRSTUPDATE} transaction. The network fee is different from the transaction fee; the transaction fee is paid to the miners, whereas the network fee was destroyed (with an {\tt OP\_RETURN}) when a {\tt NAME\_FIRSTUPDATE} transaction was confirmed. The network fee varied over time-- it started at 50 NMC at the genesis block, but decreased by a factor of 2 every 8192 blocks (which is approximately 2 months). The purpose of the network fee was to have a large initial cost to claiming names to deter users from quickly claiming all the desirable names, but then decay off so that eventually the cost of registering a name becomes negligible. As of block 85585, the network fee became small enough that it rounds to 0 and is no longer added onto the transaction. The current implementation of Namecoin has no fees other than the transaction fee on {\tt NAME\_UPDATE} transactions.

{\bf Expiration.}
Namecoin has an expiration time for names. Originally, the time period for a name to expire was 12,000 blocks, but by March 2012, the expiration period was increased to 36,000 blocks(which comes out to about 250 days). If a particular {\tt name} hasn't been mentioned in a {\tt NAME\_FIRSTUPDATE} or {\tt NAME\_UPDATE} in 36,000 blocks, the name becomes available again for any user to claim with {\tt NAME\_NEW} and {\tt NAME\_FIRSTUPDATE}. Similarly, a {\tt NAME\_UPDATE} must cite a {\tt NAME\_FIRSTUPDATE} or {\tt NAME\_UPDATE} that is less than 36,000 blocks old as input.

{\bf Changing the Protocol.}
Although it is difficult to change the protocol, it is not impossible and has already been done in Namecoin. Both the addition of merge mining with Bitcoin, and the increase in expiration length were not initially in the design of Namecoin. Both of these changes to the system required a hard fork in the block chain. In order to make these changes, the Namecoin community decided on arbitrary blocks at which point the new protocol would be enforced. For example, up to block 19,199 blocks that were merge mined with Bitcoin were not allowed into the Namceoin block chain, but starting on block 19,200 they were. 
 
\subsection{Applications}

There are many different subspaces in the Namecoin namespace, and the different subspaces have different applications. When claiming a name, a user prepends the name with a subspace ID and a slash. Namecoin was created to be very general so that it would be useful for any application that would benefit from an online name/value store. While {\tt d/} has the most registered names, there are many used subspaces in Namecoin.

{\bf .bit Domains.}
The vision for Namecoin was to use one of these subspaces for DNS lookup in the .bit TLD. Explicitly, Namecoin names associated with .bit domains are prepended with the subspace ID {\tt d/}. If a user wanted the domain awesome.bit, they would claim the name {\tt d/awesome}, and could set the value to their server address. 

{\bf OneName.}
Analyzing the names on the blockchain reveals that the online identity service, OneName, holds a very large user base. After identifying and removing probable squatters, using the strategies listed in Methods, OneName has roughly 20,000 unique name/values, which dwarfs the 1000 or so unique name/values in the d/ namespace. This provides evidence that perhaps Namecoin can be more successfully used for applications other than a domain name look-up service. The idea behind OneName is that a user can have a name/value pair in the blockchain that associates said name with different online identities such as an email, GitHub, or Twitter. If it is verified that these accounts are owned by the same person who owns the name/value pair (generally by posting a message with each of their accounts with a specific string mentioning the OneName name in the blockchain), then others can trust that a single entity owns all these accounts. 

We think there are several reasons why OneName has become more popular than d/, the most significant of which being that OneName completely abstracts away the involvement of Namecoin. In order to make a OneName identity, a user only has to visit OneName's website to create an account. OneName takes the information given to it and puts it into a name/value pair and posts that into the Namecoin blockchain. The user doesn't need to know anything about Namecoin, have Namecoins, or even know that Namecoin is working behind the scenes in order to complete the process. One reason this model works for OneName is because name/value pairs have become quite cheap. Registering a name only costs 0.01 NMC for the token and 0.01 NMC to cover two transactions fees. It then only costs 0.005 NMC every 250 days or so to update the name/values to keep them fresh. Given the current exchange rate of Namecoin to dollars, this represents a cost of approximately one cent for OneName to post one of its user's information into the blockchain. Even with a user base as large as 20,000, OneName's expenses to cover everyone's fees total to only a few hundred dollars. OneName has made the assumption that picking up the tab on the fees is well worth sparing their users the effort of trying to use Namecoin, and it seems that this approach is successful.

This leads to our next point; it isn't the cost that prevents people from registering name/values in the Namecoin blockchain, it's the inconvenience. A user who has no Namecoins to begin with is faced with large hurdles in order to register a name. The first step is acquiring a Namecoin client. While not particularly difficult to install, the standard Namecoin client requires the user to become a Namecoin node which means they will have to download, verify, and store the entire blockchain. The next obstacle for a user is to acquire coins. This is more tricky than it appears because no exchange will sell cryptocurrencies like Namecoin or Bitcoin to users who use credit cards. This is impossible for exchanges because users can challenge the charges on their card, and the exchange can't easily provide proof that they sent the coins to an address the user controls. Assuming the user has Bitcoins, or is willing to buy Bitcoins (which still has to be done without a credit card-- it could be done in person or, more commonly, the user could use Coinbase and hook a Bitcoin wallet up to their bank account), then the user will need to convert these coins to Namecoin. Many exchanges will do this, but it isn't particularly pleasant. In our experience, after making an account, the exchange required us to wait for three days before we were allowed to convert our Bitcoins to Namecoins. At this point, the user is finally ready to start making the NAME transactions outlined in the registration protocol section. They must then either remember to update their names every 250 days, or use some software that will automatically take care of updates.

This leads to an interesting question: if using Namecoins is so inconvenient that it deters potential adopters, then why does the actual system require users to pay? Most of the miners are merge mining, and the majority of their Namecoins come from the block reward, so why require a transaction fee on NAME transactions? The reason these transactions need to have associated fees is to stop squatters. Squatting is already a major issue, but it would be much worse if claiming a name was free. As it is now, if a squatter wants to register a few thousand names (as many of them do),  it represents a reasonable investment from the squatter. If the squatter has to invest a few hundred dollars, then they must feel that they can potentially earn this money back from selling some of the domains they squatted. If it costs nothing to claim a name, then the investment from the squatter is nothing, and even if they only sell one of their millions of squatted domains, then they will profit. 

The next logical step is that, because it is free, OneName should suffer from a massive number of squatters. According to the data in the blockchain, however, this is simply not true. OneName actually has a much better user to squatter ratio with only a few thousand squatters on on their namespace (including OneName itself which has also benevolently squatted some of the names in its domain space to save usernames for well known individuals). This is a result of a few different factors. The first factor contributing to this is that in order to make the name/value pairs for free, an individual needs to go through OneName. This allows OneName to implement their own anti-squatting techniques to try to prevent a single user from claiming many usernames. Additionally, because a user goes through OneName, OneName actually owns the Namecoin address that holds the token with their data. If a squatter was to squat a valuable name, they would be unable to sell it to a buyer because OneName owns it. Even if a squatter isn't intimidated by the small fee and they try to squat through the Namecoin client, squatting OneName usernames is less valuable than squatting domains in d/. A certain name in the OneName namespace is not particularly valuable because a user doesn't really need a specific name. If John Smith is using OneName, jsmith would be a pretty ideal username, but he could just as easily use jsmith1 or jsmith912. With any of these usernames, when someone searches "John Smith" in OneName, his identity will come up. This is because OneName stores an individual's actual name in the value portion of the name/value pair, and this is how most people will search for them (unlike a domain name). The name associated with this value in the blockchain is mostly just aesthetic. Finally, a squatter would be hard pressed to find buyers in this namespace. For domain names, if a user sees that a name they want is taken, they can look at the value stored on the blockchain, see that it has a squatters contact information, and contact the squatter. As discussed previously, OneName users are insulated from the Namecoin network. They would be trying to make a new account on the OneName website which would simply tell them that a particular username is taken. Even if they are willing to pay for it, they wouldn't know who to contact without having to directly engage with Namecoin themselves. 

Another final interesting fact derived from OneName's success indicates how users value the distributed cryptographic security of their information compared to the simplicity of a service. Because OneName owns all of the name/value pairs, and the users typically never validate what OneName tells them with the blockchain, the users are completely trusting it as a central authority which leaves them vulnerable. Most users find this acceptable because even though they aren't checking the Namecoin blockchain, they know that someone could be checking the Namecoin blockchain. As long as there is the potential for someone to verify the information with the blockchain, OneName can't lie without being caught. Judging by the success of OneName, users find this pseudo security to be a close enough approximation to that provided by the Namecoin blockchain if it allows them to ignore having to deal with the Namecoin protocol. 
